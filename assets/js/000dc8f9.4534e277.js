"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[60764],{3905:(e,t,n)=>{n.d(t,{Zo:()=>p,kt:()=>h});var o=n(67294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,o,r=function(e,t){if(null==e)return{};var n,o,r={},a=Object.keys(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var l=o.createContext({}),c=function(e){var t=o.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},p=function(e){var t=c(e.components);return o.createElement(l.Provider,{value:t},e.children)},u="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},m=o.forwardRef((function(e,t){var n=e.components,r=e.mdxType,a=e.originalType,l=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),u=c(n),m=r,h=u["".concat(l,".").concat(m)]||u[m]||d[m]||a;return n?o.createElement(h,i(i({ref:t},p),{},{components:n})):o.createElement(h,i({ref:t},p))}));function h(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var a=n.length,i=new Array(a);i[0]=m;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s[u]="string"==typeof e?e:r,i[1]=s;for(var c=2;c<a;c++)i[c]=n[c];return o.createElement.apply(null,i)}return o.createElement.apply(null,n)}m.displayName="MDXCreateElement"},53156:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>i,default:()=>h,frontMatter:()=>a,metadata:()=>s,toc:()=>c});var o=n(87462),r=(n(67294),n(3905));const a={},i="How to access intermediate steps",s={unversionedId:"modules/agents/agents/how_to/intermediate_steps",id:"modules/agents/agents/how_to/intermediate_steps",title:"How to access intermediate steps",description:"In order to get more visibility into what an agent is doing, we can also return intermediate steps. This comes in the form of an extra key in the return value, which is a list of (action, observation) tuples.",source:"@site/docs/modules/agents/agents/how_to/intermediate_steps.md",sourceDirName:"modules/agents/agents/how_to",slug:"/modules/agents/agents/how_to/intermediate_steps",permalink:"/langchain-docs-scratch/docs/modules/agents/agents/how_to/intermediate_steps",draft:!1,editUrl:"https://github.com/hwchase17/langchainjs/edit/main/docs/docs/modules/agents/agents/how_to/intermediate_steps.md",tags:[],version:"current",frontMatter:{},sidebar:"sidebar",previous:{title:"Handle Parsing Errors",permalink:"/langchain-docs-scratch/docs/modules/agents/agents/how_to/handle_parsing_errors"},next:{title:"How to cap the max number of iterations",permalink:"/langchain-docs-scratch/docs/modules/agents/agents/how_to/max_iterations"}},l={},c=[],p=(u="CodeOutputBlock",function(e){return console.warn("Component "+u+" was not imported, exported, or provided by MDXProvider as global scope"),(0,r.kt)("div",e)});var u;const d={toc:c},m="wrapper";function h(e){let{components:t,...n}=e;return(0,r.kt)(m,(0,o.Z)({},d,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"how-to-access-intermediate-steps"},"How to access intermediate steps"),(0,r.kt)("p",null,"In order to get more visibility into what an agent is doing, we can also return intermediate steps. This comes in the form of an extra key in the return value, which is a list of (action, observation) tuples."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"from langchain.agents import load_tools\nfrom langchain.agents import initialize_agent\nfrom langchain.agents import AgentType\nfrom langchain.llms import OpenAI\n")),(0,r.kt)("p",null,"Initialize the components needed for the agent."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},'llm = OpenAI(temperature=0, model_name=\'text-davinci-002\')\ntools = load_tools(["serpapi", "llm-math"], llm=llm)\n')),(0,r.kt)("p",null,"Initialize the agent with ",(0,r.kt)("inlineCode",{parentName:"p"},"return_intermediate_steps=True")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"agent = initialize_agent(tools, llm, agent=AgentType.ZERO_SHOT_REACT_DESCRIPTION, verbose=True, return_intermediate_steps=True)\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},'response = agent({"input":"Who is Leo DiCaprio\'s girlfriend? What is her current age raised to the 0.43 power?"})\n')),(0,r.kt)(p,{lang:"python",mdxType:"CodeOutputBlock"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},'    \n    \n    > Entering new AgentExecutor chain...\n     I should look up who Leo DiCaprio is dating\n    Action: Search\n    Action Input: "Leo DiCaprio girlfriend"\n    Observation: Camila Morrone\n    Thought: I should look up how old Camila Morrone is\n    Action: Search\n    Action Input: "Camila Morrone age"\n    Observation: 25 years\n    Thought: I should calculate what 25 years raised to the 0.43 power is\n    Action: Calculator\n    Action Input: 25^0.43\n    Observation: Answer: 3.991298452658078\n    \n    Thought: I now know the final answer\n    Final Answer: Camila Morrone is Leo DiCaprio\'s girlfriend and she is 3.991298452658078 years old.\n    \n    > Finished chain.\n'))),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},'# The actual return type is a NamedTuple for the agent action, and then an observation\nprint(response["intermediate_steps"])\n')),(0,r.kt)(p,{lang:"python",mdxType:"CodeOutputBlock"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"    [(AgentAction(tool='Search', tool_input='Leo DiCaprio girlfriend', log=' I should look up who Leo DiCaprio is dating\\nAction: Search\\nAction Input: \"Leo DiCaprio girlfriend\"'), 'Camila Morrone'), (AgentAction(tool='Search', tool_input='Camila Morrone age', log=' I should look up how old Camila Morrone is\\nAction: Search\\nAction Input: \"Camila Morrone age\"'), '25 years'), (AgentAction(tool='Calculator', tool_input='25^0.43', log=' I should calculate what 25 years raised to the 0.43 power is\\nAction: Calculator\\nAction Input: 25^0.43'), 'Answer: 3.991298452658078\\n')]\n"))),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},'import json\nprint(json.dumps(response["intermediate_steps"], indent=2))\n')),(0,r.kt)(p,{lang:"python",mdxType:"CodeOutputBlock"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},'    [\n      [\n        [\n          "Search",\n          "Leo DiCaprio girlfriend",\n          " I should look up who Leo DiCaprio is dating\\nAction: Search\\nAction Input: \\"Leo DiCaprio girlfriend\\""\n        ],\n        "Camila Morrone"\n      ],\n      [\n        [\n          "Search",\n          "Camila Morrone age",\n          " I should look up how old Camila Morrone is\\nAction: Search\\nAction Input: \\"Camila Morrone age\\""\n        ],\n        "25 years"\n      ],\n      [\n        [\n          "Calculator",\n          "25^0.43",\n          " I should calculate what 25 years raised to the 0.43 power is\\nAction: Calculator\\nAction Input: 25^0.43"\n        ],\n        "Answer: 3.991298452658078\\n"\n      ]\n    ]\n'))))}h.isMDXComponent=!0}}]);