"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[26302],{3905:(e,t,n)=>{n.d(t,{Zo:()=>d,kt:()=>h});var a=n(67294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var c=a.createContext({}),l=function(e){var t=a.useContext(c),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},d=function(e){var t=l(e.components);return a.createElement(c.Provider,{value:t},e.children)},p="mdxType",u={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},m=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,o=e.originalType,c=e.parentName,d=s(e,["components","mdxType","originalType","parentName"]),p=l(n),m=r,h=p["".concat(c,".").concat(m)]||p[m]||u[m]||o;return n?a.createElement(h,i(i({ref:t},d),{},{components:n})):a.createElement(h,i({ref:t},d))}));function h(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=n.length,i=new Array(o);i[0]=m;var s={};for(var c in t)hasOwnProperty.call(t,c)&&(s[c]=t[c]);s.originalType=e,s[p]="string"==typeof e?e:r,i[1]=s;for(var l=2;l<o;l++)i[l]=n[l];return a.createElement.apply(null,i)}return a.createElement.apply(null,n)}m.displayName="MDXCreateElement"},62341:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>i,default:()=>h,frontMatter:()=>o,metadata:()=>s,toc:()=>l});var a=n(87462),r=(n(67294),n(3905));const o={},i="Weaviate Hybrid Search",s={unversionedId:"modules/data_io/retrievers/integrations/weaviate-hybrid",id:"modules/data_io/retrievers/integrations/weaviate-hybrid",title:"Weaviate Hybrid Search",description:"Weaviate is an open source vector database.",source:"@site/docs/modules/data_io/retrievers/integrations/weaviate-hybrid.md",sourceDirName:"modules/data_io/retrievers/integrations",slug:"/modules/data_io/retrievers/integrations/weaviate-hybrid",permalink:"/langchain-docs-scratch/docs/modules/data_io/retrievers/integrations/weaviate-hybrid",draft:!1,editUrl:"https://github.com/hwchase17/langchainjs/edit/main/docs/docs/modules/data_io/retrievers/integrations/weaviate-hybrid.md",tags:[],version:"current",frontMatter:{},sidebar:"sidebar",previous:{title:"Vespa",permalink:"/langchain-docs-scratch/docs/modules/data_io/retrievers/integrations/vespa"},next:{title:"Self-querying with Weaviate",permalink:"/langchain-docs-scratch/docs/modules/data_io/retrievers/integrations/weaviate_self_query"}},c={},l=[],d=(p="CodeOutputBlock",function(e){return console.warn("Component "+p+" was not imported, exported, or provided by MDXProvider as global scope"),(0,r.kt)("div",e)});var p;const u={toc:l},m="wrapper";function h(e){let{components:t,...n}=e;return(0,r.kt)(m,(0,a.Z)({},u,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"weaviate-hybrid-search"},"Weaviate Hybrid Search"),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},(0,r.kt)("a",{parentName:"p",href:"https://weaviate.io/developers/weaviate"},"Weaviate")," is an open source vector database.")),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},(0,r.kt)("a",{parentName:"p",href:"https://weaviate.io/blog/hybrid-search-explained"},"Hybrid search")," is a technique that combines multiple search algorithms to improve the accuracy and relevance of search results. It uses the best features of both keyword-based search algorithms with vector search techniques.")),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"The ",(0,r.kt)("inlineCode",{parentName:"p"},"Hybrid search in Weaviate")," uses sparse and dense vectors to represent the meaning and context of search queries and documents.")),(0,r.kt)("p",null,"This notebook shows how to use ",(0,r.kt)("inlineCode",{parentName:"p"},"Weaviate hybrid search")," as a LangChain retriever."),(0,r.kt)("p",null,"Set up the retriever:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"#!pip install weaviate-client\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},'import weaviate\nimport os\n\nWEAVIATE_URL = os.getenv("WEAVIATE_URL")\nclient = weaviate.Client(\n    url=WEAVIATE_URL,\n    auth_client_secret=weaviate.AuthApiKey(api_key=os.getenv("WEAVIATE_API_KEY")),\n    additional_headers={\n        "X-Openai-Api-Key": os.getenv("OPENAI_API_KEY"),\n    },\n)\n\n# client.schema.delete_all()\n')),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"from langchain.retrievers.weaviate_hybrid_search import WeaviateHybridSearchRetriever\nfrom langchain.schema import Document\n")),(0,r.kt)(d,{lang:"python",mdxType:"CodeOutputBlock"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"    /workspaces/langchain/langchain/vectorstores/analyticdb.py:20: MovedIn20Warning: The ``declarative_base()`` function is now available as sqlalchemy.orm.declarative_base(). (deprecated since: 2.0) (Background on SQLAlchemy 2.0 at: https://sqlalche.me/e/b8d9)\n      Base = declarative_base()  # type: Any\n"))),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},'retriever = WeaviateHybridSearchRetriever(\n    client, index_name="LangChain", text_key="text"\n)\n')),(0,r.kt)("p",null,"Add some data:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},'docs = [\n    Document(\n        metadata={\n            "title": "Embracing The Future: AI Unveiled",\n            "author": "Dr. Rebecca Simmons",\n        },\n        page_content="A comprehensive analysis of the evolution of artificial intelligence, from its inception to its future prospects. Dr. Simmons covers ethical considerations, potentials, and threats posed by AI.",\n    ),\n    Document(\n        metadata={\n            "title": "Symbiosis: Harmonizing Humans and AI",\n            "author": "Prof. Jonathan K. Sterling",\n        },\n        page_content="Prof. Sterling explores the potential for harmonious coexistence between humans and artificial intelligence. The book discusses how AI can be integrated into society in a beneficial and non-disruptive manner.",\n    ),\n    Document(\n        metadata={"title": "AI: The Ethical Quandary", "author": "Dr. Rebecca Simmons"},\n        page_content="In her second book, Dr. Simmons delves deeper into the ethical considerations surrounding AI development and deployment. It is an eye-opening examination of the dilemmas faced by developers, policymakers, and society at large.",\n    ),\n    Document(\n        metadata={\n            "title": "Conscious Constructs: The Search for AI Sentience",\n            "author": "Dr. Samuel Cortez",\n        },\n        page_content="Dr. Cortez takes readers on a journey exploring the controversial topic of AI consciousness. The book provides compelling arguments for and against the possibility of true AI sentience.",\n    ),\n    Document(\n        metadata={\n            "title": "Invisible Routines: Hidden AI in Everyday Life",\n            "author": "Prof. Jonathan K. Sterling",\n        },\n        page_content="In his follow-up to \'Symbiosis\', Prof. Sterling takes a look at the subtle, unnoticed presence and influence of AI in our everyday lives. It reveals how AI has become woven into our routines, often without our explicit realization.",\n    ),\n]\n')),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"retriever.add_documents(docs)\n")),(0,r.kt)(d,{lang:"python",mdxType:"CodeOutputBlock"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"    ['eda16d7d-437d-4613-84ae-c2e38705ec7a',\n     '04b501bf-192b-4e72-be77-2fbbe7e67ebf',\n     '18a1acdb-23b7-4482-ab04-a6c2ed51de77',\n     '88e82cc3-c020-4b5a-b3c6-ca7cf3fc6a04',\n     'f6abd9d5-32ed-46c4-bd08-f8d0f7c9fc95']\n"))),(0,r.kt)("p",null,"Do a hybrid search:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},'retriever.get_relevant_documents("the ethical implications of AI")\n')),(0,r.kt)(d,{lang:"python",mdxType:"CodeOutputBlock"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"    [Document(page_content='In her second book, Dr. Simmons delves deeper into the ethical considerations surrounding AI development and deployment. It is an eye-opening examination of the dilemmas faced by developers, policymakers, and society at large.', metadata={}),\n     Document(page_content='A comprehensive analysis of the evolution of artificial intelligence, from its inception to its future prospects. Dr. Simmons covers ethical considerations, potentials, and threats posed by AI.', metadata={}),\n     Document(page_content=\"In his follow-up to 'Symbiosis', Prof. Sterling takes a look at the subtle, unnoticed presence and influence of AI in our everyday lives. It reveals how AI has become woven into our routines, often without our explicit realization.\", metadata={}),\n     Document(page_content='Prof. Sterling explores the potential for harmonious coexistence between humans and artificial intelligence. The book discusses how AI can be integrated into society in a beneficial and non-disruptive manner.', metadata={})]\n"))),(0,r.kt)("p",null,"Do a hybrid search with where filter:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},'retriever.get_relevant_documents(\n    "AI integration in society",\n    where_filter={\n        "path": ["author"],\n        "operator": "Equal",\n        "valueString": "Prof. Jonathan K. Sterling",\n    },\n)\n')),(0,r.kt)(d,{lang:"python",mdxType:"CodeOutputBlock"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"    [Document(page_content='Prof. Sterling explores the potential for harmonious coexistence between humans and artificial intelligence. The book discusses how AI can be integrated into society in a beneficial and non-disruptive manner.', metadata={}),\n     Document(page_content=\"In his follow-up to 'Symbiosis', Prof. Sterling takes a look at the subtle, unnoticed presence and influence of AI in our everyday lives. It reveals how AI has become woven into our routines, often without our explicit realization.\", metadata={})]\n"))))}h.isMDXComponent=!0}}]);